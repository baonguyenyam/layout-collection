"use strict";function getUIMG(){$.get("/getimg",function(t){var e=JSON.parse(t).lists,n=(JSON.parse(t).imgs,[]),i=[];for(var a in e)if(e.hasOwnProperty(a)){var o="";window.location.pathname.split("/")[2]===a&&(o=" active"),i.push('<option value="'+a+'">'+a.charAt(0).toUpperCase()+a.slice(1)+"</option>"),n.push('<a href="/view/'+a+'" class="list-group-item list-group-item-action'+o+'">'+a.charAt(0).toUpperCase()+a.slice(1)+"</a>")}$("#imgPath").append(i),$("#main-container").html(n),$("body").imagesLoaded().done(function(t){$(window).trigger("resize")})})}function getViewIMG(){$.get("/view/getimg/"+window.location.pathname.split("/")[2],function(t){var e=JSON.parse(t).lists;0<e.length?$("#pagination-container").pagination({dataSource:e,pageSize:20,className:"paginationjs-theme-info",callback:function(t,e){var n=simpleTemplating(t);$("#view-container").html(n),$("#view-container [data-fancybox]").fancybox({buttons:["zoom","share","slideShow","fullScreen","download","thumbs","close"],youtube:{controls:0,showinfo:0},afterLoad:function(t,e){e.width=e.$image[0].naturalWidth,e.height=e.$image[0].naturalHeight}}),IMGResponsive();var i=new Freewall("#view-container");i.reset({selector:".item",animate:!0,cellW:$(window).width()<=768?200:220,cellH:"auto",onResize:function(){i.fitWidth()}}),i.fitWidth(),$(window).trigger("resize")}}):$("#view-container").html('<div class="alert alert-danger" role="alert">Không có tập tin nào!</div>')})}function shuffle(t){for(var e,n,i=t.length;0!==i;)n=Math.floor(Math.random()*i),e=t[i-=1],t[i]=t[n],t[n]=e;return t}function simpleTemplating(t){var n="";return $.each(t,function(t,e){n+='<a data-fancybox="fb_'+window.location.pathname.split("/")[2]+'" href="/img/'+window.location.pathname.split("/")[2]+"/"+e+'" class="item"><img src="/img/'+window.location.pathname.split("/")[2]+"/"+e+'" /></a>'}),n+=""}function openPreview(t){$("#download").show();var e=$(t).find(".item").attr("bg-img");$(".preview .box").css({"background-position":"top left","background-size":"auto","background-image":"url("+e+")"}),$("#download").attr("data-down",e)}$(document).ready(function(){getUIMG()}),$(document).ready(function(){getViewIMG(),$("#download").on("click",function(){var e=new XMLHttpRequest,n=$(this).attr("data-down");e.open("GET",n,!0),e.responseType="blob",e.onload=function(t){download(e.response,n,"image/*")},e.send()})});